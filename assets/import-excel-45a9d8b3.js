import{r as e,j as s,a as r,E as t,G as i}from"./index-26bed70f.js";import{P as o,X as n}from"./websiteSetting-27a29c49.js";import{u as a}from"./useExcel-8aff65c6.js";import{T as l}from"./Table-b06adf33.js";import{U as c}from"./index-d0be8f67.js";import{C as d}from"./CloudUploadOutlined-174c65e4.js";import"./pickAttrs-24beb854.js";import"./List-d3c60dea.js";import"./DownOutlined-5baf3412.js";import"./iconUtil-c0a7c8f9.js";import"./objectDestructuringEmpty-47c1eead.js";import"./index-c077d20b.js";import"./index-78472baf.js";import"./CheckOutlined-8ab985aa.js";import"./useForceUpdate-b1443a11.js";import"./index-db25a9ac.js";import"./fade-14a1f7a8.js";import"./DeleteOutlined-f7888ca4.js";const m=m=>{const{Dragger:p}=c,[x,j]=e.useState([]),[u,f]=e.useState([]),{readDataFromExcel:g}=a();return s.jsx(o,{plugin:n,children:s.jsx(r,{bordered:!1,children:s.jsxs(t,{direction:"vertical",size:16,style:{width:"100%"},children:[s.jsxs(p,{accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:function(e){const{file:s}=e,r=s.originFileObj;if(!r)return;if(!/\.(xlsx|xls|csv)$/.test(r.name))return void i.warning("Excel文件只支持.xlsx, .xls, .csv格式!");r.size/1024/1024<1?function(e){const s=new FileReader;s.onload=e=>{const s=e.target&&e.target.result,{header:r,results:t}=g(s,"array"),i=r.map((e=>({title:e,dataIndex:e,align:"center"})));f(i),j(t)},s.readAsArrayBuffer(e),s.onerror=()=>{i.error("Excel文件读取出错!")}}(r):i.warning("上传的Excel文件大小不能超过1M!")},children:[s.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:0},children:s.jsx(d,{rev:void 0})}),s.jsxs("p",{children:["将Excel文件拖到此处, 或",s.jsx("span",{style:{color:"#1890ff"},children:"点击上传"})]})]}),s.jsx(l,{dataSource:x,columns:u,pagination:!1})]})})})};export{m as default};
