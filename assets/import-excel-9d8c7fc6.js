import{r as e,j as r,y as s,z as t}from"./index-b7f5d5f9.js";import{P as i,X as o}from"./websiteSetting-e91b6906.js";import{u as n}from"./useExcel-49a516ec.js";import{C as a}from"./index-ad275af7.js";import{T as l}from"./Table-dee2c8b0.js";import{U as c}from"./index-834b6e5e.js";import{C as d}from"./CloudUploadOutlined-93de7bdd.js";import"./pickAttrs-0166bd1a.js";import"./List-b9db6a34.js";import"./DownOutlined-c768d880.js";import"./iconUtil-a3c0f3b1.js";import"./objectDestructuringEmpty-47c1eead.js";import"./index-84626a90.js";import"./index-1ea97da3.js";import"./CheckOutlined-5a0c53e5.js";import"./useForceUpdate-6be73e19.js";import"./index-2c4e9876.js";import"./fade-7d047c4b.js";import"./DeleteOutlined-25565aa0.js";const m=m=>{const{Dragger:p}=c,[x,j]=e.useState([]),[u,f]=e.useState([]),{readDataFromExcel:g}=n();return r.jsx(i,{plugin:o,children:r.jsx(a,{bordered:!1,children:r.jsxs(s,{direction:"vertical",size:16,style:{width:"100%"},children:[r.jsxs(p,{accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:function(e){const{file:r}=e,s=r.originFileObj;if(!s)return;if(!/\.(xlsx|xls|csv)$/.test(s.name))return void t.warning("Excel文件只支持.xlsx, .xls, .csv格式!");s.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:s,results:t}=g(r,"array"),i=s.map((e=>({title:e,dataIndex:e,align:"center"})));f(i),j(t)},r.readAsArrayBuffer(e),r.onerror=()=>{t.error("Excel文件读取出错!")}}(s):t.warning("上传的Excel文件大小不能超过1M!")},children:[r.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:0},children:r.jsx(d,{rev:void 0})}),r.jsxs("p",{children:["将Excel文件拖到此处, 或",r.jsx("span",{style:{color:"#1890ff"},children:"点击上传"})]})]}),r.jsx(l,{dataSource:x,columns:u,pagination:!1})]})})})};export{m as default};
