import{r as n,j as r,y as C,z as a}from"./index-6bdb1630.js";import{P as E,X as b}from"./websiteSetting-c0cc6e1c.js";import{u as v}from"./useExcel-87d1311e.js";import{C as w}from"./index-00fc890e.js";import{T as y}from"./Table-26ede40f.js";import{U as F}from"./index-d129d07a.js";import{C as L}from"./CloudUploadOutlined-e9eaa43d.js";import"./pickAttrs-710cf873.js";import"./List-7d7884b5.js";import"./DownOutlined-34f111d1.js";import"./iconUtil-9e12b95f.js";import"./objectDestructuringEmpty-24e23e90.js";import"./index-e7da05d0.js";import"./index-3ee077bf.js";import"./CheckOutlined-c662cd2b.js";import"./useForceUpdate-97716f3b.js";import"./index-835b6309.js";import"./fade-1eefa93b.js";import"./DeleteOutlined-feebdfb9.js";const J=S=>{const{Dragger:l}=F,[c,m]=n.useState([]),[p,d]=n.useState([]),{readDataFromExcel:x}=v();function u(s){const{file:t}=s,e=t.originFileObj;if(!e)return;if(!/\.(xlsx|xls|csv)$/.test(e.name)){a.warning("Excel文件只支持.xlsx, .xls, .csv格式!");return}if(!(e.size/1024/1024<1)){a.warning("上传的Excel文件大小不能超过1M!");return}f(e)}function f(s){const t=new FileReader;t.onload=e=>{const o=e.target&&e.target.result,{header:g,results:h}=x(o,"array"),j=g.map(i=>({title:i,dataIndex:i,align:"center"}));d(j),m(h)},t.readAsArrayBuffer(s),t.onerror=()=>{a.error("Excel文件读取出错!")}}return r.jsx(E,{plugin:b,children:r.jsx(w,{bordered:!1,children:r.jsxs(C,{direction:"vertical",size:16,style:{width:"100%"},children:[r.jsxs(l,{accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:u,children:[r.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:0},children:r.jsx(L,{rev:void 0})}),r.jsxs("p",{children:["将Excel文件拖到此处, 或",r.jsx("span",{style:{color:"#1890ff"},children:"点击上传"})]})]}),r.jsx(y,{dataSource:c,columns:p,pagination:!1})]})})})};export{J as default};
